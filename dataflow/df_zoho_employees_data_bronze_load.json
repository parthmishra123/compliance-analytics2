{
	"name": "df_zoho_employees_data_bronze_load",
	"properties": {
		"folder": {
			"name": "Zoho/Employee"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_rest_api",
						"type": "DatasetReference"
					},
					"name": "RestSource"
				}
			],
			"sinks": [
				{
					"name": "CacheSink"
				},
				{
					"dataset": {
						"referenceName": "ds_adls_gen2_json",
						"type": "DatasetReference"
					},
					"name": "JsonSink"
				}
			],
			"transformations": [
				{
					"name": "SelectTransformation"
				}
			],
			"scriptLines": [
				"parameters{",
				"     AuthToken as string,",
				"     CDCAttribute as string,",
				"     CDCAttributeValue as string,",
				"     StartingIndex as integer,",
				"     FileName as string",
				"}",
				"source(output(",
				"          body as (response as (message as string, result as ({50699000000224005} as (Aadhaar_Number as long, AboutMe as string, Account_Holder_s_Name as string, Account_Number as string, Account_Type as string, AddedBy as string, {AddedBy.ID} as long, AddedTime as string, Address as string, Age as short, {Age.displayValue} as string, ApprovalStatus as string, Assigned_Project as string, {Assigned_Project.ID} as long, Bank_Name as string, Basic as string, {Basic.displayValue} as string, Blood_Group_1 as string, Branch as string, CTC as boolean, City as string, Confirmation_Process_Stages as string, Country as string, CreatedTime as long, Date_of_birth as string, DateofConfirmation as string, Dateofexit as string, Dateofjoining as string, Department as string, {Department.ID} as long, Designation as string, {Designation.ID} as long, EmailID as string, Emergency_Contact_Number as long, EmployeeID as string, Employee_type as string, {Employee_type.id} as long, Employeestatus as string, {Employeestatus.type} as boolean, Experience as short, {Experience.displayValue} as string, Experience_Level_at_Joining as string, Expertise as string, Extension as string, Father_s_Name as string, FirstName as string, Gender as string, Grade as string, {Grade.ID} as long, Gratuity as string, {Gratuity.displayValue} as string, HRA as string, {HRA.displayValue} as string, Hobbies as string, IFSC_Code as string, Internet as string, {Internet.displayValue} as string, LastName as string, LocationName as string, {LocationName.ID} as long, Marital_status as string, {Marital_status.id} as long, Mediclaim_Personal_Accident_and_GLT_Insurance as string, {Mediclaim_Personal_Accident_and_GLT_Insurance.displayValue} as string, Mobile as long, {Mobile.country_code} as string, ModifiedBy as string, {ModifiedBy.ID} as long, ModifiedTime as long, Nick_Name as string, Notice_Period_Status as string, Notice_Period_days as short, {Notice_Period_days.displayValue} as short, Other_Email as string, PF_Employer_s_Contribution as string, {PF_Employer_s_Contribution.displayValue} as string, PF_UAN_No as string, {PF_UAN_No.displayValue} as string, Pan_Number as string, Performance_Incentive as string, {Performance_Incentive.displayValue} as string, Photo as string, Photo_downloadUrl as string, Probation_Complition_Date as string, Probation_Period_Days as string, {Probation_Period_Days.displayValue} as string, Probation_Status as string, {Probation_Status.id} as long, Reporting_To as string, {Reporting_To.ID} as long, {Reporting_To.MailID} as string, Resume as string, Resume_downloadUrl as string, Role as string, {Role.ID} as long, Second_Reporting_To as string, {Second_Reporting_To.ID} as string, Source_of_hire as string, {Source_of_hire.id} as long, Special_Allowance as string, {Special_Allowance.displayValue} as string, State_Province as string, Stream as string, {Stream.ID} as string, Street_Address as string, Sub_Total_A as boolean, Sub_Total_E as boolean, Subtotal_B as boolean, Tags as string, Telephone as string, {Telephone.displayValue} as string, Total as boolean, Vendor_Details as string, Work_location as string, Work_phone as long, ZIP_PIN_Code as integer, ZUID as long, Zoho_ID as long, tabularSections as (Dependent as (Cell_Phone_Number as string, DependentDOB as string, DependentRelationship as string, {DependentRelationship.id} as long, Gender1 as string, {Gender1.id} as long, Name as string, {tabular.ROWID} as long)[], Documents as (Attachment as string, Attachment_downloadUrl as string, Date_of_Expiry as string, Document as string, Document_type as string, {Document_type.id} as long, {tabular.ROWID} as long)[], Education as (College as string, Degree as string, Education_AdditionalNotes as string, File_upload1 as string, File_upload1_downloadUrl as string, Interests as string, Specialization as string, Yearofgraduation as short, {tabular.ROWID} as long)[], {Work experience} as (Employer as string, File_upload as string, File_upload_downloadUrl as string, FromDate as string, Jobtitle as string, Previous_JobDesc as string, RELEVANCE as string, {RELEVANCE.id} as string, Todate as string, {tabular.ROWID} as long)[]), total_experience as short, {total_experience.displayValue} as string)[], {50699000000292057} as (Aadhaar_Number as long, AboutMe as string, Account_Holder_s_Name as string, Account_Number as long, Account_Type as string, {Account_Type.id} as long, AddedBy as string, {AddedBy.ID} as long, AddedTime as string, Address as string, Age as short, {Age.displayValue} as string, ApprovalStatus as string, Assigned_Project as string, {Assigned_Project.ID} as long, Bank_Name as string, Basic as string, {Basic.displayValue} as string, Blood_Group_1 as string, Branch as string, CTC as boolean, City as string, Confirmation_Process_Stages as string, Country as string, CreatedTime as long, Date_of_birth as string, DateofConfirmation as string, Dateofexit as string, Dateofjoining as string, Department as string, {Department.ID} as long, Designation as string, {Designation.ID} as long, EmailID as string, Emergency_Contact_Number as long, EmployeeID as string, Employee_type as string, {Employee_type.id} as long, Employeestatus as string, {Employeestatus.type} as boolean, Experience as short, {Experience.displayValue} as string, Experience_Level_at_Joining as short, Expertise as string, Extension as string, Father_s_Name as string, FirstName as string, Gender as string, Grade as string, {Grade.ID} as long, Gratuity as string, {Gratuity.displayValue} as string, HRA as string, {HRA.displayValue} as string, Hobbies as string, IFSC_Code as string, Internet as string, {Internet.displayValue} as string, LastName as string, LocationName as string, {LocationName.ID} as long, Marital_status as string, {Marital_status.id} as long, Mediclaim_Personal_Accident_and_GLT_Insurance as string, {Mediclaim_Personal_Accident_and_GLT_Insurance.displayValue} as string, Mobile as long, {Mobile.country_code} as string, ModifiedBy as string, {ModifiedBy.ID} as long, ModifiedTime as long, Nick_Name as string, Notice_Period_Status as string, Notice_Period_days as short, {Notice_Period_days.displayValue} as short, Other_Email as string, PF_Employer_s_Contribution as string, {PF_Employer_s_Contribution.displayValue} as string, PF_UAN_No as long, {PF_UAN_No.displayValue} as long, Pan_Number as string, Performance_Incentive as string, {Performance_Incentive.displayValue} as string, Photo as string, Photo_downloadUrl as string, Probation_Complition_Date as string, Probation_Period_Days as string, {Probation_Period_Days.displayValue} as string, Probation_Status as string, {Probation_Status.id} as long, Reporting_To as string, {Reporting_To.ID} as long, {Reporting_To.MailID} as string, Resume as string, Resume_downloadUrl as string, Role as string, {Role.ID} as long, Second_Reporting_To as string, {Second_Reporting_To.ID} as string, Source_of_hire as string, Special_Allowance as string, {Special_Allowance.displayValue} as string, State_Province as string, Stream as string, {Stream.ID} as string, Street_Address as string, Sub_Total_A as boolean, Sub_Total_E as boolean, Subtotal_B as boolean, Tags as string, Telephone as string, {Telephone.displayValue} as string, Total as boolean, Vendor_Details as string, Work_location as string, Work_phone as string, ZIP_PIN_Code as integer, ZUID as long, Zoho_ID as long, tabularSections as (Dependent as (Cell_Phone_Number as long, DependentDOB as string, DependentRelationship as string, {DependentRelationship.id} as long, Gender1 as string, {Gender1.id} as long, Name as string, {tabular.ROWID} as long)[], Documents as (Attachment as string, Attachment_downloadUrl as string, Date_of_Expiry as string, Document as string, Document_type as string, {Document_type.id} as long, {tabular.ROWID} as long)[], Education as (College as string, Degree as string, Education_AdditionalNotes as string, File_upload1 as string, File_upload1_downloadUrl as string, Interests as string, Specialization as string, Yearofgraduation as string, {tabular.ROWID} as long)[], {Work experience} as (Employer as string, File_upload as string, File_upload_downloadUrl as string, FromDate as string, Jobtitle as string, Previous_JobDesc as string, RELEVANCE as boolean, {RELEVANCE.id} as long, Todate as string, {tabular.ROWID} as long)[]), total_experience as short, {total_experience.displayValue} as string)[], {50699000000332021} as (Aadhaar_Number as long, AboutMe as string, Account_Holder_s_Name as string, Account_Number as long, Account_Type as string, {Account_Type.id} as long, AddedBy as string, {AddedBy.ID} as long, AddedTime as string, Address as string, Age as short, {Age.displayValue} as string, ApprovalStatus as string, Assigned_Project as string, {Assigned_Project.ID} as long, Bank_Name as string, Basic as string, {Basic.displayValue} as string, Blood_Group_1 as string, Branch as string, CTC as boolean, City as string, Confirmation_Process_Stages as string, Country as string, CreatedTime as long, Date_of_birth as string, DateofConfirmation as string, Dateofexit as string, Dateofjoining as string, Department as string, {Department.ID} as long, Designation as string, {Designation.ID} as long, EmailID as string, Emergency_Contact_Number as long, EmployeeID as string, Employee_type as string, {Employee_type.id} as long, Employeestatus as string, {Employeestatus.type} as boolean, Experience as short, {Experience.displayValue} as string, Experience_Level_at_Joining as string, Expertise as string, Extension as string, Father_s_Name as string, FirstName as string, Gender as string, Grade as string, {Grade.ID} as long, Gratuity as string, {Gratuity.displayValue} as string, HRA as string, {HRA.displayValue} as string, Hobbies as string, IFSC_Code as string, Internet as string, {Internet.displayValue} as string, LastName as string, LocationName as string, {LocationName.ID} as long, Marital_status as string, {Marital_status.id} as long, Mediclaim_Personal_Accident_and_GLT_Insurance as string, {Mediclaim_Personal_Accident_and_GLT_Insurance.displayValue} as string, Mobile as long, {Mobile.country_code} as string, ModifiedBy as string, {ModifiedBy.ID} as long, ModifiedTime as long, Nick_Name as string, Notice_Period_Status as string, Notice_Period_days as short, {Notice_Period_days.displayValue} as short, Other_Email as string, PF_Employer_s_Contribution as string, {PF_Employer_s_Contribution.displayValue} as string, PF_UAN_No as long, {PF_UAN_No.displayValue} as long, Pan_Number as string, Performance_Incentive as string, {Performance_Incentive.displayValue} as string, Photo as string, Photo_downloadUrl as string, Probation_Complition_Date as string, Probation_Period_Days as string, {Probation_Period_Days.displayValue} as string, Probation_Status as string, {Probation_Status.id} as long, Reporting_To as string, {Reporting_To.ID} as long, {Reporting_To.MailID} as string, Resume as string, Resume_downloadUrl as string, Role as string, {Role.ID} as long, Second_Reporting_To as string, {Second_Reporting_To.ID} as string, Source_of_hire as string, {Source_of_hire.id} as long, Special_Allowance as string, {Special_Allowance.displayValue} as string, State_Province as string, Stream as string, {Stream.ID} as string, Street_Address as string, Sub_Total_A as boolean, Sub_Total_E as boolean, Subtotal_B as boolean, Tags as string, Telephone as string, {Telephone.displayValue} as string, Total as boolean, Vendor_Details as string, Work_location as string, Work_phone as string, ZIP_PIN_Code as integer, ZUID as long, Zoho_ID as long, tabularSections as (Dependent as (Cell_Phone_Number as string, DependentDOB as string, DependentRelationship as string, {DependentRelationship.id} as string, Gender1 as string, {Gender1.id} as long, Name as string, {tabular.ROWID} as long)[], Documents as (Attachment as string, Attachment_downloadUrl as string, Date_of_Expiry as string, Document as string, Document_type as string, {Document_type.id} as long, {tabular.ROWID} as long)[], Education as (College as string, Degree as string, Education_AdditionalNotes as string, File_upload1 as string, File_upload1_downloadUrl as string, Interests as string, Specialization as string, Yearofgraduation as short, {tabular.ROWID} as long)[], {Work experience} as (Employer as string, File_upload as string, File_upload_downloadUrl as string, FromDate as string, Jobtitle as string, Previous_JobDesc as string, RELEVANCE as boolean, {RELEVANCE.id} as long, Todate as string, {tabular.ROWID} as long)[]), total_experience as short, {total_experience.displayValue} as string)[], {50699000001162457} as (Aadhaar_Number as long, AboutMe as string, Account_Holder_s_Name as string, Account_Number as long, Account_Type as string, {Account_Type.id} as long, AddedBy as string, {AddedBy.ID} as long, AddedTime as string, Address as string, Age as short, {Age.displayValue} as string, ApprovalStatus as string, Assigned_Project as string, {Assigned_Project.ID} as long, Bank_Name as string, Basic as string, {Basic.displayValue} as string, Blood_Group_1 as string, Branch as string, CTC as boolean, City as string, Confirmation_Process_Stages as string, Country as string, CreatedTime as long, Date_of_birth as string, DateofConfirmation as string, Dateofexit as string, Dateofjoining as string, Department as string, {Department.ID} as long, Designation as string, {Designation.ID} as long, EmailID as string, Emergency_Contact_Number as long, EmployeeID as string, Employee_type as string, {Employee_type.id} as long, Employeestatus as string, {Employeestatus.type} as boolean, Experience as boolean, {Experience.displayValue} as string, Experience_Level_at_Joining as string, Expertise as string, Extension as string, Father_s_Name as string, FirstName as string, Gender as string, Grade as string, {Grade.ID} as long, Gratuity as string, {Gratuity.displayValue} as string, HRA as string, {HRA.displayValue} as string, Hobbies as string, IFSC_Code as string, Internet as string, {Internet.displayValue} as string, LastName as string, LocationName as string, {LocationName.ID} as long, Marital_status as string, {Marital_status.id} as long, Mediclaim_Personal_Accident_and_GLT_Insurance as string, {Mediclaim_Personal_Accident_and_GLT_Insurance.displayValue} as string, Mobile as long, {Mobile.country_code} as string, ModifiedBy as string, {ModifiedBy.ID} as long, ModifiedTime as long, Nick_Name as string, Notice_Period_Status as string, Notice_Period_days as short, {Notice_Period_days.displayValue} as short, Other_Email as string, PF_Employer_s_Contribution as string, {PF_Employer_s_Contribution.displayValue} as string, PF_UAN_No as string, {PF_UAN_No.displayValue} as string, Pan_Number as string, Performance_Incentive as string, {Performance_Incentive.displayValue} as string, Photo as string, Photo_downloadUrl as string, Probation_Complition_Date as string, Probation_Period_Days as string, {Probation_Period_Days.displayValue} as string, Probation_Status as string, {Probation_Status.id} as long, Reporting_To as string, {Reporting_To.ID} as long, {Reporting_To.MailID} as string, Resume as string, Resume_downloadUrl as string, Role as string, {Role.ID} as long, Second_Reporting_To as string, {Second_Reporting_To.ID} as string, Source_of_hire as string, Special_Allowance as string, {Special_Allowance.displayValue} as string, State_Province as string, Stream as string, {Stream.ID} as string, Street_Address as string, Sub_Total_A as boolean, Sub_Total_E as boolean, Subtotal_B as boolean, Tags as string, Telephone as string, {Telephone.displayValue} as string, Total as boolean, Vendor_Details as string, Work_location as string, Work_phone as string, ZIP_PIN_Code as integer, ZUID as long, Zoho_ID as long, tabularSections as (Dependent as (Cell_Phone_Number as string, DependentDOB as string, DependentRelationship as string, {DependentRelationship.id} as string, Gender1 as string, {Gender1.id} as long, Name as string, {tabular.ROWID} as long)[], Education as (College as string, Degree as string, Education_AdditionalNotes as string, File_upload1 as string, File_upload1_downloadUrl as string, Interests as string, Specialization as string, Yearofgraduation as date, {tabular.ROWID} as long)[]), total_experience as short, {total_experience.displayValue} as string)[])[], status as boolean, uri as string)),",
				"          headers as [string,string]",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     httpMethod: 'GET',",
				"     timeout: 30,",
				"     headers: ['Authorization' -> (concat('Zoho-oauthtoken ', $AuthToken))],",
				"     queryParameters: ['sIndex' -> ($StartingIndex), ($CDCAttribute) -> ($CDCAttributeValue)],",
				"     paginationRules: ['supportRFC5988' -> 'true'],",
				"     responseFormat: ['type' -> 'json', 'documentForm' -> 'documentPerLine']) ~> RestSource",
				"RestSource select(mapColumn(",
				"          status = body.response.status",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectTransformation",
				"SelectTransformation sink(validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     store: 'cache',",
				"     format: 'inline',",
				"     output: true,",
				"     saveOrder: 1) ~> CacheSink",
				"RestSource sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:[($FileName)],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 2,",
				"     partitionBy('hash', 1)) ~> JsonSink"
			]
		}
	}
}